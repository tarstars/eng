\documentclass[14pt]{extarticle}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

% \setlength{\parindent}{4em}
% \setlength{\parskip}{1em}

\renewcommand{\baselinestretch}{2.0}
\begin{document}
If you ask some contemporary mathematician how to extract
periodical structure from a data, most probable answer will
be "use the Fourier transformation". Really, it is very
powerful method and it found it's applications in the
data analysis, image processing, digital signals processing.
But, nevertheless, it has some limitations.

Fourier analysis only allows to detect sine component if
the frequency of this component is exact multiplier
of the carrier frequency that is inverse of discretization
step. Otherwise one obtains a lot of non-zero components
in the Fourier-spectrum even if a signal contains, for example,
only three sine components.

In order to overcome this limitation it is possible to apply
Prony method. It consists of two steps. Before we can proceed
to the description of the first step, let us discuss some relatively
simple, but very interesting and important mathematical observation.

Gaspar de Prony was a scientist. One of his many areas of interest was
experiments with expanding gases. Once he decided that results of his
experiments can be described as a sum of exponential functions. I don't
know precisely a nature of his experiments, but let us assume that he
measured dependency of some value on time. In this case one exponent term
has the form $A\exp(\omega t)$, where $A$ is an amplitude of the component and
$\omega$ is a frequency. Probably, Gaspar was interested mainly in the real
values of $\omega$ because they corresponds to the monotonous function.
However, it is quite possible for $\omega$ to be a complex number. In this case
real part tells us if the process is taking strength with time goes by if \(\Re \omega > 0\), or,
on the contrary, it is a quenching process if \(\Re \omega < 0\). When \(\omega\)
has non-zero imaginary part $\Im \omega$ things become more interesting, because
this part corresponds to oscillations.

Firt interesting mathematical fact is that progression of exponential term values in evenly distributed time moments
is geometric progression. Indeed, let us consider three evenly distributed time moments 
$t_1, t_2, t_3$. Due to even distribution there is equation $t_3 - t_2 = t_2 - t_1 = \Delta$.
Values of exponent term are \(v_1 = A_1\exp(\omega_1 t_1), v_2 = A_1\exp(\omega_1 t_2), v_3 = A_1\exp(\omega_1 t_3)\).
If ratio of \(v_2\) to \(v_1\) is equal to ratio of \(v_3\) to \(v_2\), values \(v_1, v_2, v_3\) forms geometric progression.
Inded, \(v_2/v_1 = \exp(\omega_1(t_2 - t_1)) = \exp(\omega_1\Delta)\) and \(v_3/v_2 = \exp(\omega_1(t_3 - t_2)) = \exp(\omega_1\Delta)\).
Therefore \(v_2/v_1 = \exp(\omega_1\Delta) = v_3/v_2\). It is convenient to introduce
new variable \(q\) as follows \(q = \exp (\Delta)\).

Then, it is easy to demonstrate that a geometric progression satisfies a recurrency relation.
%
Let such relation has form 
\begin{equation}
 v_{i+2} = a v_{i+1} + b v_{i}
 \label{recurrency_eq}
\end{equation} 
%
We can substitute values using
formula for general term of geometric progression \(v_i = q^i\) and obtain polynomial equation
\begin{equation}
q^2 = a q + b.
\label{square_eq}
\end{equation}
%
Obviously this approach can be applied to the recurrency relations of
higher order.

\newpage
Beauty of this approach is that both sides of the recurrency relation can be multiplied by some
constant. 
%
It means that amplitude part of signal has no influence on these equations.
%
Therefore we can use them to determine a frequency of our signal.
%
To do it, we need to determine coefficients \(a\) and \(b\) in the recurrency relation.
%
It is easy.
%
Really, if we have \(n\) experimental points \(p_1, p_2, \ldots, p_n\) it is possible to write  
down \(n-3\) recurrency relations (\ref{recurrency_eq}).
%
Now we have a lot of equations and only two variables. 
%
It is well-known problem. 
%
There is no ``right'' solution for this problem.
%
But, at least, we can minimize discrepancy between left and right
parts of the equations.
%
Since squared difference is a good measure of the discrepancy, usually
sum of these is minimized and this procedure called the Least Squares Method.
%
Least Squares Method consists in organazing of experimental values in matrices \(X\) and vector \(Y\)
and calculation of the expression \((X^T X)^{-1}X^T Y\).
%
It gives us values of \(a\) and \(b\).

Common ratio \(q\) of the geometric progression can be obtained by solving quadratic
equation (\ref{square_eq}).
%
In most practical cases this equation gives two conjugated complex numbers \(q_1\) and \(q_2\) as its roots.
%
Each root corresponds to exponentialy decaying sine function of time.
%
General term for such kind of signal is \(p(t) = A \exp (-\gamma t) \sin (\omega + \phi)\).
%
Real part of \(q\) is related to \(\gamma\) and \(\omega\).
%6
To full reconstruction of signal it is necessary to estimate values of \(A\) and
\(\phi\).
%
Fortunately, we can do it in similar way.6
%
Indeed, we have expression for the experimental values
\begin{equation}
    p_t = A q_1^t + B q_2^t.
    \label{weighted_sum}
\end{equation}
%
Just as before, substitution of the data in these equations gives us overdefined system
that can be solved by the Least Squares Method.
%
Things are a little bit tricky now because \(A\) and \(B\) are complex numbers.
%
The simplest approach to interpret (\ref{weighted_sum}) as real number is to take
real part of this expression.
%


\end{document}

